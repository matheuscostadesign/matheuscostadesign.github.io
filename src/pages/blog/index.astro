---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => 
  new Date(b.id.substring(0, 10)).getTime() - new Date(a.id.substring(0, 10)).getTime()
);

const truncate = (str: string, length: number) => {
  return str.length > length ? str.substring(0, length - 3) + '...' : str;
};
---

<BaseLayout 
  title="Blog - Matheus Costa - UX/UI Designer e Desenvolvedor Front-end em SÃ£o JosÃ© do Rio Preto/SP"
  description="Profissional especializado em criaÃ§Ã£o de sites em SÃ£o JosÃ© do Rio Preto/SP"
>
  <div class="bg-[url('/assets/images/bg-blog.jpg')] bg-center bg-cover w-full h-[30rem] flex items-center justify-center text-center pt-20">
    <div class="title">
      <h1 class="text-white text-[4.8rem] font-semibold leading-tight mb-6">Todos artigos no blog</h1>
      <p class="text-text-primary mt-6">Neste blog compartilho dicas e novos conhecimentos adquiridos sobre desenvolvimento web e design UX/UI ðŸ‘Š</p>
    </div>
  </div>

  <section class="bg-gray-600 py-32">
    <div class="w-full max-w-[110rem] mx-auto px-6">
      <div class="grid grid-cols-[repeat(auto-fill,minmax(300px,1fr))] gap-12 mb-20 max-[820px]:grid-cols-1">
        {sortedPosts.map((post) => (
          <a href={`/blog/${post.slug}`} class="flex flex-col bg-gray-500 rounded-[1.6rem] overflow-hidden transition-transform duration-300 no-underline hover:-translate-y-3">
            <img class="w-full h-80 object-cover block" src={post.data.image} alt={post.data.title} />
            <h3 class="text-white text-[2rem] px-6 pt-6 pb-3 m-0">{truncate(post.data.title, 48)}</h3>
            <p class="text-text-primary px-6 pb-6 m-0">{truncate(post.data.description, 78)}</p>
          </a>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>
